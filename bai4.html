<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√†i 4</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/test.css">
</head>
<body class="flex flex-col items-center justify-between min-h-screen bg-gray-100">
    <header >
        <h1 class="textheader">An Kh√πng</h1>
        <button id="exit-button" class="btnExit">Tho√°t</button>
        <a href="index.html" class="btnHome">
            <i class="fa-solid fa-arrow-left" style="color: rgb(0, 0, 0); font-size: 20px; font-weight: bold; margin-left: 8px;"></i>Trang Ch·ªß.
        </a>
    </header>
    <!-- Container ch√≠nh (Chia l√†m 2 c·ªôt tr√™n m√†n h√¨nh l·ªõn) -->
    <div class="container mx-auto px-4 my-8 grid grid-cols-1 md:grid-cols-10 gap-8 items-start">
        <!-- KHUNG B√äN TR√ÅI: N·ªòI DUNG C√ÇU H·ªéI (7/10 c·ªôt) -->
        <div id="quiz-container" class="bg-white p-8 rounded-2xl shadow-xl w-full md:col-span-7">
            <!-- M√†n h√¨nh b·∫Øt ƒë·∫ßu b√†i ki·ªÉm tra -->
            <div id="start-screen" class="text-center">
                <h1 class="text-3xl font-bold text-gray-900 mb-4">B√†i 4</h1>
                <p class="text-gray-600 mb-6">Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi b√†i ki·ªÉm tra! H√£y nh·∫•n "B·∫Øt ƒë·∫ßu" ƒë·ªÉ b·∫Øt ƒë·∫ßu.</p>
                <button id="start-button" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105">B·∫Øt ƒë·∫ßu</button>
            </div>
            <!-- N·ªôi dung Quiz: Hi·ªÉn th·ªã c√¢u h·ªèi v√† ƒë√°p √°n -->
            <div id="quiz-content" class="hidden">
                <!-- B·ªô ƒë·∫øm c√¢u h·ªèi (VD: 1/10) -->
                <p id="question-counter" class="text-lg font-semibold text-gray-700 mb-2"></p>
                <!-- Ti√™u ƒë·ªÅ/N·ªôi dung c√¢u h·ªèi -->
                <h2 id="question-text" class="text-xl text-gray-1500 mb-2"></h2><br>
                <!-- H√¨nh minh h·ªça c√¢u h·ªèi (n·∫øu c√≥) -->
                <div id="question-image-container" class="mb-4 hidden">
                    <img id="question-image" src="" alt="Minh h·ªça c√¢u h·ªèi" class="mx-auto rounded-xl shadow-lg max-h-64 object-contain">
                </div>
                <!-- Th√¥ng b√°o cho c√¢u h·ªèi Multi-Select -->
                <p id="multiselect-info" class="text-sm text-red-500 font-medium mb-4 hidden"><i>2 ƒë√°p √°n ƒë√∫ng!</i></p>
                <!-- 1. Container cho Single/Multi-Select (Ch·ªçn ƒë√°p √°n) -->
                <div id="options-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <!-- C√°c n√∫t ƒë√°p √°n ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                </div>
                <!-- 2. Container cho Drag & Drop (K√©o th·∫£) -->
                <div id="dragdrop-container" class="hidden">
                    <p class="text-sm text-blue-500 font-medium mb-4">K√©o th·∫£ theo √Ω ƒë√∫ng</p>
                    <!-- V√πng k√©o (Source): Ch·ª©a c√°c th·∫ª ch∆∞a ƒë∆∞·ª£c th·∫£ -->
                    <div id="draggable-items-source" class="source-drop-zone drop-zone flex flex-wrap gap-3 p-4 bg-gray-50 border rounded-xl mb-6 shadow-inner">
                        <p class="text-gray-500 text-sm italic w-full source-placeholder">K√©o c√°c th·∫ª ·ªü ƒë√¢y... </p>
                    </div>
                    <!-- V√πng th·∫£ (Targets): Ch·ª©a c√°c Category -->
                    <div id="drop-targets-container" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    </div>
                </div>
                <!-- 3. Container cho Fill-in-the-Blank (ƒêi·ªÅn t·ª´) -->
                <div id="fill-in-the-blank-container" class="space-y-4 hidden mt-6">
                    <div class="flex flex-col sm:flex-row gap-4">
                        <input 
                            type="text" 
                            id="fill-in-the-blank-input" 
                            placeholder="Nh·∫≠p ƒë√°p √°n c·ªßa b·∫°n..." 
                            class="flex-grow p-3 border border-gray-300 rounded-lg transition duration-150"
                        >
                        <button 
                            id="check-fill-in-the-blank-button"
                            class="check-button-enabled text-black font-bold py-2 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 disabled:bg-gray-400"
                            onclick="checkFillInTheBlank()"
                        >
                            Ki·ªÉm tra ƒë√°p √°n
                        </button>
                    </div>
                </div>
                <!-- Thanh ƒëi·ªÅu h∆∞·ªõng d∆∞·ªõi c√πng -->
                <div class="flex justify-end items-center mt-6 border-t pt-4 space-x-4">
                    <button 
                        id="check-answer-button" 
                        class="hidden text-black font-bold py-2 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105"
                    >
                        Ki·ªÉm tra
                    </button>
                    <button 
                        id="next-button" 
                        class="bg-gray-200 text-gray-800 font-bold py-2 px-6 rounded-full shadow-md transition-all duration-300 transform hover:scale-105"
                    >
                        Ti·∫øp
                    </button>
                </div>
            </div>
            <!-- M√†n h√¨nh k·∫øt qu·∫£ cu·ªëi b√†i thi -->
            <div id="results-screen" class="hidden text-center">
                <h2 class="text-3xl font-bold text-green-600 mb-4">Ho√†n th√†nh b√†i ki·ªÉm tra!</h2>
                <!-- HI·ªÇN TH·ªä ƒêI·ªÇM S·ªê ƒê√É T·ªêI ∆ØU H√ìA -->
                <div class="bg-blue-50 p-6 rounded-2xl shadow-xl inline-block mb-6">
                    <p class="text-xl font-semibold text-gray-700">ƒêi·ªÉm s·ªë c·ªßa b·∫°n:</p>
                    <!-- Th·∫ª hi·ªÉn th·ªã ƒëi·ªÉm s·ªë cu·ªëi c√πng -->
                    <p id="final-score" class="text-6xl font-extrabold text-blue-700 mt-2">0 / 0</p>
                </div>
                <p id="result-message" class="text-gray-700 mb-6">B·∫°n c√≥ th·ªÉ xem l·∫°i c√°c c√¢u tr·∫£ l·ªùi c·ªßa m√¨nh tr√™n giao di·ªán.</p>
                <button id="restart-button" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-6 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105">L√†m l·∫°i</button>
            </div>
        </div>
        <!-- KHUNG B√äN PH·∫¢I: SIDEBAR (3/10 c·ªôt) -->
        <div id="sidebar" class="bg-white p-6 rounded-2xl shadow-xl w-full hidden md:block md:col-span-3 sticky top-8">
            <div class="mb-6 text-center">
                <p class="text-xl font-semibold text-gray-700 mb-2">Th·ªùi gian l√†m b√†i:</p>
                <!-- ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c/ƒë·∫øm th·ªùi gian -->
                <div id="timer" class="text-4xl font-bold text-red-500">00:00</div>
            </div>
            <div>
                <p class="text-lg font-semibold text-gray-700 mb-4">Danh s√°ch c√¢u h·ªèi:</p>
                <!-- Danh s√°ch c√°c n√∫t c√¢u h·ªèi ƒë·ªÉ nh·∫£y qua l·∫°i -->
                <div id="question-list-container" class="grid grid-cols-4 gap-2">
                    <!-- C√°c n√∫t c√¢u h·ªèi ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                </div>
            </div>
        </div>
    </div>
    <!-- Footer -->
    <footer class="w-full bg-gray-800 text-white text-center py-4 px-6 mt-auto">
        <p class="text-sm">&copy; Website luy·ªán t·∫≠p!!!</p>
    </footer>
    <script>
        let questions = [
        // C√¢u 1
        {
            question: "Infrastructure as Code (IaC) l√† g√¨?",
            options: [
                "A. Qu·∫£n l√Ω h·∫° t·∫ßng b·∫±ng c√°ch vi·∫øt m√£ c·∫•u h√¨nh",
                "B. C√†i ƒë·∫∑t h·ªá ƒëi·ªÅu h√†nh b·∫±ng tay",
                "C. T·∫°o b√°o c√°o t√†i ch√≠nh",
                "D. Vi·∫øt ph·∫ßn m·ªÅm qu·∫£n l√Ω c∆° s·ªü d·ªØ li·ªáu"
            ],
            answer: "A. Qu·∫£n l√Ω h·∫° t·∫ßng b·∫±ng c√°ch vi·∫øt m√£ c·∫•u h√¨nh",
            type: "single_select"
        },
        // C√¢u 2
        {
            question: "Ansible l√† c√¥ng c·ª• ph·ªï bi·∫øn d√πng cho?",
            options: [
                "A. Thi·∫øt k·∫ø giao di·ªán",
                "B. Infrastructure as Code",
                "C. Ph√°t tri·ªÉn ·ª©ng d·ª•ng di ƒë·ªông",
                "D. Qu·∫£n l√Ω nh√¢n s·ª±"
            ],
            answer: "B. Infrastructure as Code",
            type: "single_select"
        },
        // C√¢u 3
        {
            question: "T·ªáp c·∫•u h√¨nh Ansible th∆∞·ªùng ƒë∆∞·ª£c vi·∫øt d∆∞·ªõi ƒë·ªãnh d·∫°ng?",
            options: [
                "A. .yml",
                "B. .docx",
                "C. .pdf",
                "D. .exe"
            ],
            answer: "A. .yml",
            type: "single_select"
        },
        // C√¢u 4
        {
            question: "L·ª£i √≠ch ch√≠nh c·ªßa IaC l√† g√¨?",
            options: [
                "A. Kh√¥ng c·∫ßn vi·∫øt code",
                "B. Giao di·ªán ƒë·ªì h·ªça d·ªÖ d√πng",
                "C. Tri·ªÉn khai h·∫° t·∫ßng c√≥ th·ªÉ l·∫∑p l·∫°i, ki·ªÉm so√°t ƒë∆∞·ª£c",
                "D. Ho·∫°t ƒë·ªông ngo·∫°i tuy·∫øn"
            ],
            answer: "C. Tri·ªÉn khai h·∫° t·∫ßng c√≥ th·ªÉ l·∫∑p l·∫°i, ki·ªÉm so√°t ƒë∆∞·ª£c",
            type: "single_select"
        },
        // C√¢u 5
        {
            question: "Vai tr√≤ c·ªßa Ansible trong m√¥ h√¨nh IaC l√† g√¨?",
            options: [
                "A. Qu·∫£n l√Ω phi√™n b·∫£n m√£ ngu·ªìn",
                "B. G·ª≠i email nh·∫Øc nh·ªü trong n·ªôi b·ªô",
                "C. Theo d√µi KPI nh√¢n s·ª±",
                "D. C·∫•u h√¨nh v√† tri·ªÉn khai h·∫° t·∫ßng t·ª± ƒë·ªông"
            ],
            answer: "D. C·∫•u h√¨nh v√† tri·ªÉn khai h·∫° t·∫ßng t·ª± ƒë·ªông",
            type: "single_select"
        },
        // C√¢u 6
        {
            question: "M·ªôt ∆∞u ƒëi·ªÉm n·ªïi b·∫≠t c·ªßa IaC so v·ªõi c·∫•u h√¨nh th·ªß c√¥ng l√† ?",
            options: [
                "A. D·ªÖ h·ªçc h∆°n ng√¥n ng·ªØ Python",
                "B. T·ªëc ƒë·ªô g√µ l·ªánh nhanh h∆°n",
                "C. ƒê∆∞·ª£c vi·∫øt b·∫±ng Java, n√™n r·∫•t d·ªÖ ƒë·ªçc v√† d·ªÖ hi·ªÉu",
                "D. T·ª± ƒë·ªông h√≥a v√† ki·ªÉm so√°t thay ƒë·ªïi qua Git"
            ],
            answer: "D. T·ª± ƒë·ªông h√≥a v√† ki·ªÉm so√°t thay ƒë·ªïi qua Git",
            type: "single_select"
        },
        // C√¢u 7
        {
            question: "ƒê·ªãnh d·∫°ng ph·∫ßn m·ªü r·ªông file c·∫•u h√¨nh m·∫∑c ƒë·ªãnh c·ªßa Ansible v√† Terraform l√† g√¨?",
            options: [
                "A. yml v√† .tf",
                "B. .xml v√† .cfg",
                "C. .ini v√† .tax",
                "D. .json v√† .doc"
            ],
            answer: "A. yml v√† .tf",
            type: "single_select"
        },
        // C√¢u 8
        {
            question: "ƒêi·ªÉm kh√°c bi·ªát gi·ªØa IaC v√† IaaS l√† g√¨?",
            options: [
                "A. IaC d√πng trong t√†i ch√≠nh, IaaS trong m·∫°ng x√£ h·ªôi",
                "B. IaC l√† m·ªôt lo·∫°i IaaS",
                "C. IaC l√† ph∆∞∆°ng ph√°p tri·ªÉn khai, IaaS l√† d·ªãch v·ª• n·ªÅn t·∫£ng",
                "D. C·∫£ hai l√† ph·∫ßn m·ªÅm qu·∫£n l√Ω nh√¢n s·ª±"
            ],
            answer: "C. IaC l√† ph∆∞∆°ng ph√°p tri·ªÉn khai, IaaS l√† d·ªãch v·ª• n·ªÅn t·∫£ng",
            type: "single_select"
        },
        // C√¢u 9.1
        {
            question: "Ansible ch·ªâ d√πng ƒë·ªÉ t·∫°o h·∫° t·∫ßng m·ªõi v√† kh√¥ng th·ªÉ c·∫•u h√¨nh ph·∫ßn m·ªÅm ho·∫∑c d·ªãch v·ª• tr√™n m√°y ch·ªß.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai",
            type: "single_select"
        },
        // C√¢u 9.2

        {
            question: "Terraform s·ª≠ d·ª•ng m√¥ h√¨nh khai b√°o (declarative) ƒë·ªÉ ƒë·ªãnh nghƒ©a h·∫° t·∫ßng d∆∞·ªõi d·∫°ng m√£ (Infrastructure as Code).",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 9.3

        {
            question: "Terraform c√≥ th·ªÉ d√πng ƒë·ªÉ c·∫•p ph√°t t√†i nguy√™n h·∫° t·∫ßng tr√™n nhi·ªÅu nh√† cung c·∫•p nh∆∞ AWS, Azure, GCP.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 9.4

        {
            question: "Ansible ch·ªß y·∫øu d√πng ƒë·ªÉ c·∫•u h√¨nh ph·∫ßn m·ªÅm, tri·ªÉn khai ·ª©ng d·ª•ng, v√† qu·∫£n l√Ω c·∫•u h√¨nh - kh√¥ng ch·ªâ t·∫°o h·∫° t·∫ßng.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 10.1

        {
            question: "Ansible c√≥ th·ªÉ ƒë∆∞·ª£c d√πng ƒë·ªÉ c√†i ƒë·∫∑t ph·∫ßn m·ªÅm tr√™n EC2 ƒë√£ ƒë∆∞·ª£c t·∫°o tr√™n AWS.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 10.2

        {
            question: "ƒê·ªÉ ch·∫°y Ansible v·ªõi AWS, b·∫Øt bu·ªôc ph·∫£i c√†i ƒë·∫∑t AWS CLI v√† c√†i ƒë·∫∑t c·∫£ c√°c ti·ªán √≠ch n√¢ng cao.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai",
            type: "single_select"
        },
        // C√¢u 10.3

        {
            question: "Ansible kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi EC2 n·∫øu kh√¥ng c√≥ file .pem c·ªßa key pair t∆∞∆°ng ·ª©ng.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 10.4

        {
            question: "C√≥ th·ªÉ d√πng Ansible ƒë·ªÉ t·∫°o h·∫° t·∫ßng EC2 tr√™n AWS m√† kh√¥ng c·∫ßn Terraform hay CloudFormation.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 11.1

        {
            question: "ansible_user=ec2-user l√† user m·∫∑c ƒë·ªãnh cho Amazon Linux khi d√πng SSH t·ª´ Ansible.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 11.2

        {
            question: "Ansible kh√¥ng th·ªÉ s·ª≠ d·ª•ng bi·∫øn (variables) ƒë·ªÉ c·∫•u h√¨nh AWS resources.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai",
            type: "single_select"
        },
        // C√¢u 11.3

        {
            question: "Ansible ch·ªâ ho·∫°t ƒë·ªông ƒë∆∞·ª£c v·ªõi Ubuntu EC2, kh√¥ng t∆∞∆°ng th√≠ch v·ªõi Amazon Linux.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai",
            type: "single_select"
        },
        // C√¢u 11.4

        {
            question: "File key .pem d√πng ƒë·ªÉ SSH v√†o EC2 ph·∫£i ƒë∆∞·ª£c ƒë·∫∑t ƒë√∫ng quy·ªÅn v·ªõi l·ªánh chmod 400.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 12.1

        {
            question: "Trong playbook Ansible, m√¥-ƒëun amazon.aws.ec2_instance ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ c·∫•u h√¨nh EC2.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai", 
            type: "single_select"
        },
        // C√¢u 12.2

        {
            question: "Ansible c√≥ th·ªÉ d√πng ƒë·ªÉ x√≥a t√†i nguy√™n AWS nh∆∞ EC2, VPC, S3.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng", 
            type: "single_select"
        },
        // C√¢u 12.3

        {
            question: "Ansible c√≥ th·ªÉ d√πng ƒë·ªÉ c√†i ƒë·∫∑t NGINX tr√™n nhi·ªÅu EC2 instance c√πng l√∫c.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 12.4

        {
            question: "Ansible y√™u c·∫ßu ph·∫£i ƒë∆∞·ª£c c√†i ƒë·∫∑t tr√™n t·∫•t c·∫£ EC2 instance mu·ªën c·∫•u h√¨nh.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai", 
            type: "single_select"
        },
        // C√¢u 13.1

        {
            question: "Kh√¥ng th·ªÉ d√πng dynamic inventory v·ªõi Ansible ƒë·ªÉ l·∫•y danh s√°ch EC2 t·ª± ƒë·ªông t·ª´ AWS, v√¨ Ansible KH√îNG h·ªó tr·ª£ dynamic inventory th√¥ng qua plugin aws_ec2.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "B. Sai", 
            type: "single_select"
        },
        // C√¢u 13.2

        {
            question: "File inventory c·ªßa Ansible c√≥ th·ªÉ ch·ª©a ƒë·ªãa ch·ªâ IP public c·ªßa EC2 instance.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 13.3

        {
            question: "ƒê·ªÉ s·ª≠ d·ª•ng dynamic inventory v·ªõi AWS, ta c·∫ßn c√†i th√™m m√¥-ƒëun boto3.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng", 
            type: "single_select"
        },
        // C√¢u 13.4

        {
            question: "C√≥ th·ªÉ s·ª≠ d·ª•ng Ansible ƒë·ªÉ c·∫•u h√¨nh b·∫£o m·∫≠t (security group) tr√™n AWS.",
            options: ["A. ƒê√∫ng", "B. Sai"],
            answer: "A. ƒê√∫ng",
            type: "single_select"
        },
        // C√¢u 14
        {
            question: "ƒê√¢u l√† m·ªôt th·ªÉ hi·ªán c·ªßa IaaS?",
            options: [
                "A. Trello",
                "B. GitHub",
                "C. Google Docs",
                "D. Amazon EC2"
            ],
            answer: "D. Amazon EC2",
            type: "single_select"
        },
        // C√¢u 15
        {
            question: "C√°c nh√† cung c·∫•p d·ªãch v·ª• IaaS ph·ªï bi·∫øn g·ªìm: _____?",
            options: [
                "A. VSCode, PyCharm, Eclipse",
                "B. Photoshop, Canva, Illustrator",
                "C. YouTube, Netflix, Spotify",
                "D. AWS, Azure, Google Cloud"
            ],
            answer: "D. AWS, Azure, Google Cloud",
            type: "single_select"
        },
        // C√¢u 16
        {
            question: "Terraform kh√°c Ansible ·ªü ƒëi·ªÉm n√†o trong m·ª•c ƒë√≠ch s·ª≠ d·ª•ng?",
            options: [
                "A. Ansible c·∫ßn m√°y ch·ªß ri√™ng ƒë·ªÉ ho·∫°t ƒë·ªông",
                "B. Terraform d√πng ƒë·ªÉ khai b√°o v√† qu·∫£n l√Ω h·∫° t·∫ßng, c√≤n Ansible ch·ªß y·∫øu d√πng ƒë·ªÉ c·∫•u h√¨nh h·ªá th·ªëng",
                "C. Terraform l√† c√¥ng c·ª• ƒë·ªÉ ki·ªÉm th·ª≠ API",
                "D. C·∫£ hai ƒë·ªÅu kh√¥ng c·∫ßn t·ªáp c·∫•u h√¨nh"
            ],
            answer: "B. Terraform d√πng ƒë·ªÉ khai b√°o v√† qu·∫£n l√Ω h·∫° t·∫ßng, c√≤n Ansible ch·ªß y·∫øu d√πng ƒë·ªÉ c·∫•u h√¨nh h·ªá th·ªëng",
            type: "single_select"
        },
        // C√¢u 17
        {
            question: "Infrastructure as a Service (IaaS) l√† g√¨?",
            options: [
                "A. M√¥ h√¨nh ki·∫øn tr√∫c ph·∫ßn m·ªÅm",
                "B. D·ªãch v·ª• cho thu√™ ph·∫ßn c·ª©ng ·∫£o h√≥a qua internet",
                "C. M·ªôt h·ªá ƒëi·ªÅu h√†nh m·ªõi",
                "D. H·ªá th·ªëng ERP doanh nghi·ªáp"
            ],
            answer: "B. D·ªãch v·ª• cho thu√™ ph·∫ßn c·ª©ng ·∫£o h√≥a qua internet",
            type: "single_select"
        },
        // C√¢u 18
        {
            question: "IaaS th∆∞·ªùng y√™u c·∫ßu ng∆∞·ªùi d√πng t·ª± qu·∫£n l√Ω ?",
            options: [
                "A. Tr√¨nh duy·ªát web",
                "B. D·ªãch v·ª• ph·∫ßn m·ªÅm ho√†n ch·ªânh",
                "C. H·∫° t·∫ßng v·∫≠t l√Ω",
                "D. ·ª®ng d·ª•ng v√† h·ªá ƒëi·ªÅu h√†nh"
            ],
            answer: "D. ·ª®ng d·ª•ng v√† h·ªá ƒëi·ªÅu h√†nh",
            type: "single_select"
        },
        // C√¢u 19
        {
            question: "Terraform v√† Ansible ƒë·ªÅu l√† c√¥ng c·ª• ______?",
            options: [
                "A. M·∫°ng n·ªôi b·ªô",
                "B. D·ªãch v·ª• SaaS",
                "C. L∆∞u tr·ªØ file",
                "D. Infrastructure as Code (IaC)"
            ],
            answer: "D. Infrastructure as Code (IaC)",
            type: "single_select"
        },
        // C√¢u 20
        {
            question: "Ansible ƒë∆∞·ª£c vi·∫øt b·∫±ng ng√¥n ng·ªØ l·∫≠p tr√¨nh n√†o?",
            options: [
                "A. Python",
                "B. C",
                "C. Rust",
                "D. Go"
            ],
            answer: "A. Python",
            type: "single_select"
        },
        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "K√©o ƒë√∫ng m·ª•c ƒë√≠ch v√†o l·ªánh t∆∞∆°ng ·ª©ng ƒë·ªÉ ki·ªÉm tra k·∫øt n·ªëi:",
            type: "drag_drop",
            categories: ["ansible-playbook test.yml", "ansible all -m ping"],
            items: [
                { id: "item1", text: "Ch·∫°y playbook test.yml", correctCategory: "ansible-playbook test.yml" },
                { id: "item2", text: "Ki·ªÉm tra SSH k·∫øt n·ªëi ƒë·∫øn t·∫•t c·∫£ host", correctCategory: "ansible all -m ping" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "Gh√©p ƒë√∫ng h√†nh ƒë·ªông v·ªõi c√∫ ph√°p l·ªánh t∆∞∆°ng ·ª©ng:",
            type: "drag_drop",
            categories: ["ansible-playbook site.yml ‚Äìtags ‚Äúweb‚Äù", "‚Äìskip-tags"],
            items: [
                { id: "item1", text: "Ch·∫°y c√°c task c√≥ g·∫Øn tag ch·ªâ ƒë·ªãnh", correctCategory: "ansible-playbook site.yml ‚Äìtags ‚Äúweb‚Äù" },
                { id: "item2", text: "B·ªè qua task c√≥ tag ch·ªâ ƒë·ªãnh", correctCategory: "‚Äìskip-tags" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "Gh√©p ƒë√∫ng c√°c b∆∞·ªõc trong qu√° tr√¨nh s·ª≠ d·ª•ng Ansible ƒë·ªÉ c√†i NGINX l√™n EC2:",
            type: "drag_drop",
            categories: ["B∆∞·ªõc 1", "B∆∞·ªõc 2", "B∆∞·ªõc 3", "B∆∞·ªõc 4"],
            items: [
                { id: "item1", text: "T·∫°o EC2 v√† x√°c ƒë·ªãnh IP/public DNS", correctCategory: "B∆∞·ªõc 1" },
                { id: "item2", text: "C√†i Ansible tr√™n m√°y ƒëi·ªÅu khi·ªÉn (VD: WSL)", correctCategory: "B∆∞·ªõc 2" },
                { id: "item3", text: "T·∫°o inventory v√† playbook Ansible", correctCategory: "B∆∞·ªõc 3" },
                { id: "item4", text: "Ch·∫°y l·ªánh ansible-playbook install-nginx.yml", correctCategory: "B∆∞·ªõc 4" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "K√©o ƒë√∫ng m√¥ t·∫£ v·ªõi t√™n module Ansible d√πng ƒë·ªÉ c√†i NGINX tr√™n Amazon Linux:",
            type: "drag_drop",
            categories: ["apt", "yum", "package"],
            items: [
                { id: "item1", text: "D√†nh cho Ubuntu/Debian", correctCategory: "apt" },
                { id: "item2", text: "D√†nh cho Amazon Linux/CentOS", correctCategory: "yum" },
                { id: "item3", text: "Module tr·ª´u t∆∞·ª£ng h√≥a, h·ªó tr·ª£ c·∫£ yum/apt t√πy OS", correctCategory: "package" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "K√©o ƒë√∫ng √Ω nghƒ©a c·ªßa l·ªánh ƒë·ªÉ ki·ªÉm tra phi√™n b·∫£n Ansible ƒë√£ c√†i tr√™n WSL:",
            type: "drag_drop",
            categories: ["ansible ‚Äìversion", "check ansible_for_all_version"],
            items: [
                { id: "item1", text: "Ki·ªÉm tra phi√™n b·∫£n Ansible", correctCategory: "ansible ‚Äìversion" },
                { id: "item2", text: "Sai c√∫ ph√°p ho·∫∑c kh√¥ng t·ªìn t·∫°i", correctCategory: "check ansible_for_all_version" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "Gh√©p m·ª•c ƒë√≠ch s·ª≠ d·ª•ng v·ªõi l·ªánh Ansible t∆∞∆°ng ·ª©ng:",
            type: "drag_drop",
            categories: ["ansible-playbook", "ansible-inventory", "ansible --help"],
            items: [
                { id: "item1", text: "Ch·∫°y playbook ƒë·ªãnh nghƒ©a nhi·ªÅu task", correctCategory: "ansible-playbook" },
                { id: "item2", text: "Qu·∫£n l√Ω & ki·ªÉm tra th√¥ng tin inventory", correctCategory: "ansible-inventory" },
                { id: "item3", text: "Hi·ªÉn th·ªã tr·ª£ gi√∫p chi ti·∫øt (help) v·ªÅ c√°ch s·ª≠ d·ª•ng c√°c l·ªánh ansible", correctCategory: "ansible --help" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "Gh√©p ph·∫ßn c·∫•u h√¨nh li√™n quan ƒë·∫øn l·ªánh t∆∞∆°ng ·ª©ng:",
            type: "drag_drop",
            categories: ["-i inventory.ini", "--private-key ~/.ssh/key.pem", "-u ubuntu"],
            items: [
                { id: "item1", text: "Ch·ªâ ƒë·ªãnh inventory file", correctCategory: "-i inventory.ini" },
                { id: "item2", text: "Ch·ªâ ƒë·ªãnh file SSH ƒë·ªÉ k·∫øt n·ªëi", correctCategory: "--private-key ~/.ssh/key.pem" },
                { id: "item3", text: "Ch·∫°y l·ªánh v·ªõi user ubuntu", correctCategory: "-u ubuntu" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "K√©o ƒë√∫ng c·∫∑p m√¥ t·∫£ v·ªõi th√†nh ph·∫ßn t∆∞∆°ng ·ª©ng:",
            type: "drag_drop",
            categories: [".pem file", "install-nginx.yml", "inventory.ini"],
            items: [
                { id: "item1", text: "Kh√≥a SSH ƒë·ªÉ k·∫øt n·ªëi ƒë·∫øn EC2 t·ª´ Ansible", correctCategory: ".pem file" },
                { id: "item2", text: "Playbook ch·ª©a task c√†i ƒë·∫∑t", correctCategory: "install-nginx.yml" },
                { id: "item3", text: "Danh s√°ch IP c√°c EC2 ƒë·ªÉ Ansible k·∫øt n·ªëi", correctCategory: "inventory.ini" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "Gh√©p m√¥ t·∫£ logic v·ªõi m·ªánh l·ªánh t∆∞∆°ng ·ª©ng:",
            type: "drag_drop",
            categories: ["ansible-playbook deploy.yml --check", "ansible-playbook.yml --diff"],
            items: [
                { id: "item1", text: "Ch·∫°y th·ª≠ (dry-run) xem c√≥ thay ƒë·ªïi g√¨", correctCategory: "ansible-playbook deploy.yml --check" },
                { id: "item2", text: "Hi·ªÉn th·ªã n·ªôi dung thay ƒë·ªïi trong file c·∫•u h√¨nh", correctCategory: "ansible-playbook.yml --diff" },
            ]
        },

        // C√ÇU H·ªéI K√âO TH·∫¢ (DRAG & DROP)
        {
            question: "K√©o ƒë√∫ng lo·∫°i file ƒë∆∞·ª£c d√πng trong l·ªánh t∆∞∆°ng ·ª©ng:",
            type: "drag_drop",
            categories: ["ansible-playbook", "ansible"],
            items: [
                { id: "item1", text: "D√πng v·ªõi file .yml", correctCategory: "ansible-playbook" },
                { id: "item2", text: "Kh√¥ng c·∫ßn file", correctCategory: "ansible" },
            ]
        },

                    
        ];
        let currentQuestionIndex = 0; // Ch·ªâ s·ªë c√¢u h·ªèi hi·ªán t·∫°i
        let elapsedTime = 0; // Th·ªùi gian l√†m b√†i (gi√¢y)
        let timerInterval; // Bi·∫øn l∆∞u tr·ªØ Interval c·ªßa ƒë·ªìng h·ªì
        let answeredQuestions = new Array(questions.length).fill(null);
        let correctnessStatus = new Array(questions.length).fill(null);
        // L·∫•y c√°c ph·∫ßn t·ª≠ DOM c·∫ßn thi·∫øt
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const quizContent = document.getElementById('quiz-content');
        const questionCounter = document.getElementById('question-counter');
        const multiselectInfo = document.getElementById('multiselect-info');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const dragdropContainer = document.getElementById('dragdrop-container');
        const draggableItemsSource = document.getElementById('draggable-items-source');
        const dropTargetsContainer = document.getElementById('drop-targets-container');
        const fillInTheBlankContainer = document.getElementById('fill-in-the-blank-container');
        const fillInTheBlankInput = document.getElementById('fill-in-the-blank-input');
        const checkFillInTheBlankButton = document.getElementById('check-fill-in-the-blank-button');
        const checkAnswerButton = document.getElementById('check-answer-button'); // N√∫t ki·ªÉm tra chung (Multi-select, Drag & Drop)
        const nextButton = document.getElementById('next-button');
        const resultsScreen = document.getElementById('results-screen');
        const restartButton = document.getElementById('restart-button');
        // S·ª¨A L·ªñI V√Ä T√çNH ƒêI·ªÇM: Th√™m c√°c d√≤ng n√†y ƒë·ªÉ khai b√°o bi·∫øn DOM
        const resultMessage = document.getElementById('result-message'); 
        const exitButton = document.getElementById('exit-button'); 
        const finalScore = document.getElementById('final-score'); // Th·∫ª hi·ªÉn th·ªã ƒëi·ªÉm s·ªë
        
        const sidebar = document.getElementById('sidebar');
        const timerDisplay = document.getElementById('timer');
        const questionListContainer = document.getElementById('question-list-container');
        function normalizeString(str) {
            let normalized = str.toLowerCase().trim();
            normalized = normalized.normalize('NFD').replace(/[\u0300-\u036f]/g, "");
            return normalized.replace(/\s+/g, '');
        }
        fillInTheBlankInput.onkeypress = (event) => {
            if (event.key === 'Enter') checkFillInTheBlank();
        };
        function drag(event) {
            event.dataTransfer.setData("text/plain", event.target.id);
            event.target.classList.add('opacity-50');
        }
        function dragEnd(event) {
            event.target.classList.remove('opacity-50');
        }
        function allowDrop(event) {
            event.preventDefault(); // Cho ph√©p th·∫£
            const target = event.target.closest('.drop-zone') || event.target.closest('.source-drop-zone');
            if (target) {
                target.classList.add('drag-over');
            }
        }
        function dragLeave(event) {
             const target = event.target.closest('.drop-zone') || event.target.closest('.source-drop-zone');
            if (target) {
                target.classList.remove('drag-over');
            }
        }
        function drop(event, categoryName) {
            event.preventDefault();
            let targetZone = event.target.closest('.drop-zone') || event.target.closest('.source-drop-zone');
            // N·∫øu ƒë√£ ki·ªÉm tra (c√≥ feedback), kh√¥ng cho ph√©p t∆∞∆°ng t√°c
            if (!targetZone || correctnessStatus[currentQuestionIndex] !== null) return; 
            targetZone.classList.remove('drag-over');
            const itemId = event.dataTransfer.getData("text/plain");
            const draggedElement = document.getElementById(itemId);
            if (draggedElement) {
                const oldParent = draggedElement.parentElement;
                if (oldParent) {
                    oldParent.removeChild(draggedElement);
                }
                targetZone.appendChild(draggedElement);
                let currentAnswer = answeredQuestions[currentQuestionIndex] || {};
                const itemText = draggedElement.textContent.trim(); 

                const isDroppedBackToSource = targetZone.id === 'draggable-items-source';

                if (isDroppedBackToSource) {
                    delete currentAnswer[itemText]; 
                } else { 
                    currentAnswer[itemText] = categoryName;
                }
                answeredQuestions[currentQuestionIndex] = Object.keys(currentAnswer).length > 0 ? currentAnswer : null;
                updateButtonStates();
            }
        }
        function checkCorrectness(questionIndex, selectedAnswers) {
            const currentQuestion = questions[questionIndex];
            if (currentQuestion.type === "drag_drop") {
                const droppedAnswers = selectedAnswers || answeredQuestions[questionIndex];
                if (!droppedAnswers) return false;
                if (Object.keys(droppedAnswers).length !== currentQuestion.items.length) {
                    return false;
                }
                return currentQuestion.items.every(item => {
                    const droppedCategory = droppedAnswers[item.text];
                    return droppedCategory === item.correctCategory;
                });
            } else if (currentQuestion.type === "fill_in_the_blank") {
                 const userAnswer = selectedAnswers || answeredQuestions[questionIndex];
                 if (!userAnswer) return false;
                 const normalizedUserAnswer = normalizeString(userAnswer);
                 const normalizedCorrectAnswer = normalizeString(currentQuestion.answer);

                 return normalizedUserAnswer === normalizedCorrectAnswer;
            } else {
                const correctAnswers = Array.isArray(currentQuestion.answer) ? currentQuestion.answer : [currentQuestion.answer];
                if (!Array.isArray(selectedAnswers)) {
                    selectedAnswers = selectedAnswers !== null ? [selectedAnswers] : [];
                }
                if (selectedAnswers.length !== correctAnswers.length) {
                    return false;
                }
                selectedAnswers.sort();
                correctAnswers.sort();
                return JSON.stringify(selectedAnswers) === JSON.stringify(correctAnswers);
            }
        }
        function showQuestion() {
            const currentQuestion = questions[currentQuestionIndex];
            questionCounter.textContent = `C√¢u h·ªèi: ${currentQuestionIndex + 1} / ${questions.length}`;
            questionText.innerHTML = currentQuestion.question;
            // ======= HI·ªÇN TH·ªä H√åNH ·∫¢NH MINH H·ªåA N·∫æU C√ì =======
            const imageContainer = document.getElementById("question-image-container");
            const imageElement = document.getElementById("question-image");
            if (currentQuestion.image) {
                imageElement.src = currentQuestion.image;
                imageContainer.classList.remove("hidden");
            } else {
                imageContainer.classList.add("hidden");
            }
            optionsContainer.classList.add('hidden');
            multiselectInfo.classList.add('hidden');
            dragdropContainer.classList.add('hidden');
            fillInTheBlankContainer.classList.add('hidden'); 
            checkAnswerButton.classList.add('hidden'); 
            if (currentQuestion.type === "drag_drop") {
                renderDragDropUI(currentQuestion);
                dragdropContainer.classList.remove('hidden');
            } else if (currentQuestion.type === "fill_in_the_blank") {
                renderFillInTheBlankUI(currentQuestion);
                fillInTheBlankContainer.classList.remove('hidden');
            } else {
                renderSelectUI(currentQuestion);
                optionsContainer.classList.remove('hidden');
            }
            nextButton.textContent = currentQuestionIndex >= questions.length - 1 ? "Ho√†n th√†nh b√†i thi" : "C√¢u ti·∫øp theo";
            updateButtonStates();
            updateSidebarHighlight();
        }
        function renderSelectUI(currentQuestion) {
            const isMulti = currentQuestion.type === "multi_select";
            multiselectInfo.classList.toggle('hidden', !isMulti);
            checkAnswerButton.classList.toggle('hidden', !isMulti); // Hi·ªÉn th·ªã n√∫t ki·ªÉm tra ch·ªâ cho Multi-Select
            optionsContainer.innerHTML = '';
            const savedAnswer = answeredQuestions[currentQuestionIndex];
            const savedAnswersArray = Array.isArray(savedAnswer) ? savedAnswer : (savedAnswer !== null ? [savedAnswer] : []);
            const isChecked = correctnessStatus[currentQuestionIndex] !== null;
            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.innerHTML = option;
                let classes = [
                    "answer-button", "w-full", "py-3", "px-4", "rounded-xl", "text-center", 
                    "bg-gray-100", "border-2", "border-gray-300", 
                    "transition-all", "duration-200",
                    "font-medium", "text-gray-800", "shadow-sm"
                ];
                button.classList.add(...classes);
                if (isChecked) {
                    button.disabled = true;
                    button.classList.add("cursor-not-allowed");
                    const correctAnswers = Array.isArray(currentQuestion.answer) ? currentQuestion.answer : [currentQuestion.answer];
                    const isCorrectOption = correctAnswers.includes(option);
                    const isUserSelected = savedAnswersArray.includes(option);
                    if (isCorrectOption) {
                        button.classList.add("bg-green-500", "text-white", "border-green-600");
                        button.classList.remove("bg-gray-100", "border-gray-300");
                    }
                    if (isUserSelected && !isCorrectOption) {
                        button.classList.add("bg-red-500", "text-white", "border-red-600");
                        button.classList.remove("bg-green-500", "border-green-600", "bg-gray-100", "border-gray-300");
                    }
                } else {
                    button.classList.add("hover:bg-blue-100", "hover:border-blue-500");
                    if (isMulti) {
                        button.addEventListener('click', (e) => {
                            toggleSelection(e.currentTarget);
                            updateButtonStates(); 
                        });
                    } else {
                        button.addEventListener('click', (e) => singleSelectCheck(option, e.currentTarget));
                    }
                    if (savedAnswersArray.includes(option)) {
                        button.classList.add('selected-option');
                    }
                }
                optionsContainer.appendChild(button);
            });
        }
        function renderFillInTheBlankUI(currentQuestion) {
            const isChecked = correctnessStatus[currentQuestionIndex] !== null;
            const savedAnswer = answeredQuestions[currentQuestionIndex] || "";
            fillInTheBlankInput.value = savedAnswer;
            fillInTheBlankInput.disabled = isChecked;
            fillInTheBlankInput.classList.remove('correct', 'incorrect');
            checkFillInTheBlankButton.classList.toggle('hidden', isChecked);
            if (isChecked) {
                const isCorrect = correctnessStatus[currentQuestionIndex];
                fillInTheBlankInput.classList.add(isCorrect ? 'correct' : 'incorrect');
                if (!isCorrect) {
                     fillInTheBlankInput.placeholder = `ƒê√°p √°n ƒë√∫ng: ${currentQuestion.answer}`;
                }
            } else {
                fillInTheBlankInput.placeholder = "Nh·∫≠p ƒë√°p √°n c·ªßa b·∫°n...";
            }
            updateButtonStates(); 
        }
        function checkFillInTheBlank() {
            const userAnswer = fillInTheBlankInput.value.trim();
            if (userAnswer === "") {
                showMessage("Vui l√≤ng nh·∫≠p ƒë√°p √°n v√†o √¥ tr·ªëng.", "yellow");
                return;
            }// 1. L∆∞u ƒë√°p √°n
            answeredQuestions[currentQuestionIndex] = userAnswer;
            checkAndApplyFeedback(currentQuestionIndex); 
            fillInTheBlankInput.disabled = true;
            checkFillInTheBlankButton.classList.add('hidden');
            updateButtonStates(); 
        }// --- Render Logic cho Drag & Drop ---
        function renderDragDropUI(currentQuestion) {
            draggableItemsSource.innerHTML = '';
            dropTargetsContainer.innerHTML = '';
            const savedDrops = answeredQuestions[currentQuestionIndex] || {};
            const isChecked = correctnessStatus[currentQuestionIndex] !== null;
            const itemsDataMap = new Map(currentQuestion.items.map(item => [item.text, item]));
            checkAnswerButton.classList.remove('hidden');
            const sourcePlaceholder = document.createElement('p');
            sourcePlaceholder.classList.add('text-gray-500', 'text-sm', 'italic', 'w-full', 'source-placeholder');
            draggableItemsSource.ondragover = allowDrop;
            draggableItemsSource.ondragleave = dragLeave;
            if (!isChecked) {
                draggableItemsSource.ondrop = (e) => drop(e, null); 
                sourcePlaceholder.textContent = 'K√©o c√°c th·∫ª ·ªü ƒë√¢y... (K√©o th·∫ª t·ª´ √¥ ƒë√°p √°n v·ªÅ ƒë√¢y ƒë·ªÉ "k√©o ra")'; 
                sourcePlaceholder.classList.toggle('hidden', currentQuestion.items.length !== Object.keys(savedDrops).length);
            } else {
                draggableItemsSource.ondrop = null; // V√¥ hi·ªáu h√≥a k√©o/th·∫£
                sourcePlaceholder.textContent = 'ƒê√£ ho√†n th√†nh.';
                sourcePlaceholder.classList.add('hidden'); 
            }
            draggableItemsSource.appendChild(sourcePlaceholder);
            const dropZones = {};
            currentQuestion.categories.forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.classList.add('bg-gray-50', 'p-4', 'rounded-xl', 'shadow-md', 'flex', 'flex-col');
                const title = document.createElement('h3');
                title.textContent = category;
                title.classList.add('text-lg', 'font-bold', 'text-blue-700', 'mb-3', 'border-b', 'pb-2');
                categoryDiv.appendChild(title);
                const dropZone = document.createElement('div');
                dropZone.classList.add('drop-zone', 'flex', 'flex-wrap', 'gap-2', 'p-3', 'rounded-lg', 'flex-grow');
                dropZone.setAttribute('data-category', category);
                if (!isChecked) {
                    dropZone.ondragover = allowDrop;
                    dropZone.ondragleave = dragLeave;
                    dropZone.ondrop = (e) => drop(e, category); 
                } else {
                    dropZone.ondrop = null; 
                    dropZone.style.cursor = 'default';
                    const correctItemsForCategory = currentQuestion.items.filter(item => item.correctCategory === category);
                    const droppedItems = Object.entries(savedDrops)
                        .filter(([itemText, cat]) => cat === category)
                        .map(([itemText]) => itemText);
                    const correctlyPlacedCount = droppedItems.filter(text => itemsDataMap.get(text).correctCategory === category).length;
                    const incorrectlyPlacedCount = droppedItems.length - correctlyPlacedCount;
                    const missingCorrectCount = correctItemsForCategory.length - correctlyPlacedCount;
                    if (incorrectlyPlacedCount > 0 || missingCorrectCount > 0) {
                        dropZone.classList.add('incorrect-drop-zone');
                    } else if (correctlyPlacedCount > 0 && incorrectlyPlacedCount === 0 && missingCorrectCount === 0) {
                        dropZone.classList.add('correct-drop-zone');
                    }
                }
                dropTargetsContainer.appendChild(categoryDiv).appendChild(dropZone);
                dropZones[category] = dropZone;
            });
            currentQuestion.items.forEach(item => {
                const itemEl = createDraggableItem(item, isChecked);
                const droppedCategory = savedDrops[item.text];
                if (droppedCategory) {
                    const targetZone = dropZones[droppedCategory];
                    if (targetZone) {
                        targetZone.appendChild(itemEl);
                    }
                    if (isChecked) {
                        const isCorrect = droppedCategory === item.correctCategory;
                        itemEl.classList.remove('bg-white', 'border-gray-300');
                        itemEl.classList.add('text-gray-900', 'shadow-md', 'ring-2');
                        if (isCorrect) {
                            itemEl.classList.add('bg-green-200', 'ring-green-500');
                        } else {
                            itemEl.classList.add('bg-red-200', 'ring-red-500');
                            const correctHint = document.createElement('span');
                            correctHint.textContent = `(ƒê√∫ng: ${item.correctCategory})`;
                            correctHint.classList.add('text-xs', 'text-red-700', 'mt-1', 'block', 'font-normal');
                            itemEl.appendChild(correctHint);
                        }
                    }
                } else {// Item ch∆∞a ƒë∆∞·ª£c th·∫£ -> ƒê·∫∑t v√†o v√πng Source
                    draggableItemsSource.appendChild(itemEl);
                }
            });// ·∫®n placeholder Source n·∫øu kh√¥ng c√≤n item n√†o
            const placeholder = draggableItemsSource.querySelector('.source-placeholder');
            if (placeholder) placeholder.classList.toggle('hidden', currentQuestion.items.length === Object.keys(savedDrops).length);
        }// H√†m t·∫°o element cho th·∫ª k√©o
        function createDraggableItem(item, isChecked) {
            const itemEl = document.createElement('div');
            itemEl.id = item.id;
            itemEl.textContent = item.text;
            itemEl.classList.add(
                'draggable-item', 'p-3', 'rounded-lg', 'shadow-sm', 'font-medium', 'text-sm', 'text-gray-800'
            );
            if (!isChecked) {
                itemEl.setAttribute('draggable', 'true');
                itemEl.ondragstart = drag;
                itemEl.ondragend = dragEnd;
            } else {
                itemEl.setAttribute('draggable', 'false');
                itemEl.style.cursor = 'default';
            }
            return itemEl;
        }// --- Logic X·ª≠ l√Ω ƒê√°p √°n (Select) ---
        function toggleSelection(button) {
            button.classList.toggle('selected-option');
        }
        function singleSelectCheck(selectedOption, button) {
            answeredQuestions[currentQuestionIndex] = selectedOption;
            checkAndApplyFeedback(currentQuestionIndex);
            renderSelectUI(questions[currentQuestionIndex]);
            updateButtonStates();
        }// X·ª≠ l√Ω n√∫t CHECK ANSWER (cho Multi-Select v√† Drag & Drop)
        checkAnswerButton.addEventListener('click', () => {
            const currentQuestion = questions[currentQuestionIndex];
            if (currentQuestion.type === "multi_select") {
                const allOptionButtons = optionsContainer.querySelectorAll('button');
                const selectedOptions = Array.from(allOptionButtons)
                    .filter(btn => btn.classList.contains('selected-option'))
                    .map(btn => btn.textContent);
                if (selectedOptions.length === 0) {
                    showMessage("Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt ƒë√°p √°n tr∆∞·ªõc khi ki·ªÉm tra.", "yellow");
                    return;
                }// L∆∞u ƒë√°p √°n v√† ki·ªÉm tra
                answeredQuestions[currentQuestionIndex] = selectedOptions;
                checkAndApplyFeedback(currentQuestionIndex);
                renderSelectUI(questions[currentQuestionIndex]);
            } else if (currentQuestion.type === "drag_drop") {
                const droppedAnswers = answeredQuestions[currentQuestionIndex];
                const isAllDropped = droppedAnswers !== null && droppedAnswers && Object.keys(droppedAnswers).length === currentQuestion.items.length;
                if (!isAllDropped) {
                    showMessage("Vui l√≤ng k√©o th·∫£ t·∫•t c·∫£ c√°c th·∫ª v√†o v·ªã tr√≠ tr∆∞·ªõc khi ki·ªÉm tra.", "yellow");
                    return;
                }
                checkAndApplyFeedback(currentQuestionIndex);
                renderDragDropUI(questions[currentQuestionIndex]); // Render l·∫°i ƒë·ªÉ hi·ªÉn th·ªã feedback
            }
            updateButtonStates();
        });
        // H√†m ki·ªÉm tra v√† √°p d·ª•ng ph·∫£n h·ªìi
        function checkAndApplyFeedback(questionIndex) {
            const savedAnswer = answeredQuestions[questionIndex];
            const isCorrect = checkCorrectness(questionIndex, savedAnswer);
            const currentQuestionType = questions[questionIndex].type;
            if (isCorrect) {
                showMessage("üéâ Ch√∫c m·ª´ng, ƒë√°p √°n ch√≠nh x√°c!", "green");
            } else {
                if (currentQuestionType === "fill_in_the_blank") {
                     showMessage(`Sai r·ªìi. ƒê√°p √°n ƒë√∫ng l√†: ${questions[questionIndex].answer}.`, "red");
                } else if (currentQuestionType === "drag_drop") {
                     showMessage(`Sai r·ªìi. ƒê√°p √°n k√©o th·∫£ ch∆∞a ho√†n to√†n ch√≠nh x√°c. Vui l√≤ng xem ph·∫£n h·ªìi m√†u s·∫Øc!`, "red");
                } else {
                     showMessage("Sai r·ªìi. Vui l√≤ng xem l·∫°i k·∫øt qu·∫£ (M√†u xanh l√° l√† ƒë√∫ng, ƒë·ªè l√† sai)!", "red");
                }
            }
            correctnessStatus[questionIndex] = isCorrect;
            // X·ª≠ l√Ω feedback cho Fill-in-the-Blank (c·∫ßn g·ªçi l·∫°i renderFillInTheBlankUI ƒë·ªÉ update placeholder)
            if (currentQuestionType === "fill_in_the_blank") {
                renderFillInTheBlankUI(questions[questionIndex]);
            }
            updateSidebarHighlight(); // C·∫≠p nh·∫≠t m√†u s·∫Øc tr√™n sidebar
            return isCorrect;
        }
        function updateButtonStates() {
            const currentQuestion = questions[currentQuestionIndex];
            const isChecked = correctnessStatus[currentQuestionIndex] !== null;
            nextButton.disabled = !isChecked;
            nextButton.classList.toggle('bg-gray-200', !isChecked);
            nextButton.classList.toggle('text-gray-800', !isChecked);
            nextButton.classList.toggle('enabled-next', isChecked);
            if (currentQuestion.type === "multi_select" || currentQuestion.type === "drag_drop") {
                checkAnswerButton.classList.toggle('hidden', isChecked);
                if (!isChecked) {
                    let isAnswered = false;
                    if (currentQuestion.type === "drag_drop") {
                        const droppedAnswers = answeredQuestions[currentQuestionIndex];
                        isAnswered = droppedAnswers !== null && droppedAnswers && Object.keys(droppedAnswers).length === currentQuestion.items.length;
                    } else if (currentQuestion.type === "multi_select") {
                        const currentSelections = optionsContainer.querySelectorAll('.selected-option').length;
                        isAnswered = currentSelections > 0;
                    }
                    checkAnswerButton.disabled = !isAnswered;
                    checkAnswerButton.classList.toggle('check-button-enabled', isAnswered);
                    checkAnswerButton.classList.toggle('check-button-disabled', !isAnswered);
                }
            }// 3. Logic cho n√∫t CHECK FILL-IN-THE-BLANK
            if (currentQuestion.type === "fill_in_the_blank") {
                if (!isChecked) {
                    const isAnswered = fillInTheBlankInput.value.trim() !== "";
                    checkFillInTheBlankButton.disabled = !isAnswered;
                    checkFillInTheBlankButton.classList.toggle('check-button-enabled', isAnswered);
                    checkFillInTheBlankButton.classList.toggle('check-button-disabled', !isAnswered);
                    fillInTheBlankInput.oninput = updateButtonStates; 
                }
            }
        }
        nextButton.addEventListener('click', nextQuestion);
        function nextQuestion() {
            if (correctnessStatus[currentQuestionIndex] === null) {
                const currentType = questions[currentQuestionIndex].type;
                if (currentType === "multi_select" || currentType === "drag_drop" || currentType === "fill_in_the-blank") {
                    showMessage("Vui l√≤ng nh·∫•n n√∫t 'Ki·ªÉm tra ƒë√°p √°n' tr∆∞·ªõc khi chuy·ªÉn c√¢u.", "yellow");
                    return;
                }
            }// Chuy·ªÉn sang c√¢u ti·∫øp theo (ho·∫∑c ho√†n th√†nh b√†i thi)
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }
        function jumpToQuestion(index) {
            currentQuestionIndex = index;
            showQuestion();
        }
        function goToStartScreen() {
            clearInterval(timerInterval);
            elapsedTime = 0; 
            timerDisplay.textContent = "00:00"; // ƒê·∫∑t l·∫°i ƒë·ªìng h·ªì hi·ªÉn th·ªã
            quizContent.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            sidebar.classList.add('hidden');
            startScreen.classList.remove('hidden');
        }
        function showResults() {
            clearInterval(timerInterval);
            quizContent.classList.add('hidden');
            resultsScreen.classList.remove('hidden');
            
            const totalCorrect = correctnessStatus.filter(status => status === true).length;
            const totalQuestions = questions.length;
            // T·ªêI ∆ØU H√ìA T√çNH ƒêI·ªÇM: C·∫≠p nh·∫≠t th·∫ª hi·ªÉn th·ªã ƒëi·ªÉm s·ªë
            finalScore.textContent = `${totalCorrect} / ${totalQuestions}`;
            if (totalCorrect === totalQuestions) {
                resultMessage.textContent = `B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng ${totalCorrect} / ${totalQuestions} c√¢u. Xin ch√∫c m·ª´ng! B·∫°n ƒë·∫°t k·∫øt qu·∫£ tuy·ªát ƒë·ªëi.`;
            } else {
                resultMessage.textContent = `B·∫°n ƒë√£ tr·∫£ l·ªùi ƒë√∫ng ${totalCorrect} / ${totalQuestions} c√¢u. H√£y xem l·∫°i c√°c c√¢u tr·∫£ l·ªùi c·ªßa m√¨nh tr√™n giao di·ªán nh√©.`;
            }
            sidebar.classList.add('hidden');
        }
        function restartQuiz() {
            currentQuestionIndex = 0;
            answeredQuestions = new Array(questions.length).fill(null);
            correctnessStatus = new Array(questions.length).fill(null);
            resultsScreen.classList.add('hidden');
            quizContent.classList.remove('hidden');
            sidebar.classList.remove('hidden'); 
            startTimer();
            createQuestionList(); 
            showQuestion();
        }
        function startTimer() {
            clearInterval(timerInterval); 
            timerInterval = setInterval(() => {
                elapsedTime++;
                const minutes = Math.floor(elapsedTime / 60);
                const seconds = elapsedTime % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }
        function createQuestionList() {
            questionListContainer.innerHTML = '';
            questions.forEach((q, index) => {
                const button = document.createElement('button');
                button.textContent = index + 1;
                button.classList.add(
                    "w-8", "h-8", "rounded-full", "font-medium", "text-sm",
                    "bg-gray-200", "text-gray-800", "hover:bg-blue-200",
                    "transition-colors", "duration-200"
                );
                button.setAttribute('data-index', index);
                button.addEventListener('click', () => {
                    jumpToQuestion(index);
                });
                questionListContainer.appendChild(button);
            });
        }
        function updateSidebarHighlight() {
            const allQuestionButtons = questionListContainer.querySelectorAll('button');
            allQuestionButtons.forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white', 'bg-green-500', 'bg-red-500', 'bg-yellow-400');
                const index = parseInt(btn.getAttribute('data-index'));
                if (index === currentQuestionIndex) {
                    btn.classList.add('bg-blue-600', 'text-white');
                } else if (correctnessStatus[index] === true) {
                    btn.classList.add('bg-green-500', 'text-white');
                } else if (correctnessStatus[index] === false) {
                    btn.classList.add('bg-red-500', 'text-white');
                } else if (answeredQuestions[index] !== null) {
                    btn.classList.add('bg-yellow-400', 'text-white');
                }
            });
        }
        function showMessage(text, color) {
            const existingMessage = quizContent.querySelector('.temp-message');
            if (existingMessage) existingMessage.remove();
            const colorClasses = {
                "yellow": "bg-yellow-100 border-yellow-400 text-yellow-700",
                "red": "bg-red-100 border-red-400 text-red-700",
                "green": "bg-green-100 border-green-400 text-green-700"
            };
            const messageBox = document.createElement('div');
            messageBox.textContent = text;
            const colorClassString = colorClasses[color] || colorClasses['yellow'];
            messageBox.classList.add(
                ...colorClassString.split(' '), 
                "border", "px-4", "py-3", "rounded", "relative", "mb-4", "temp-message"
            );
            quizContent.insertBefore(messageBox, questionCounter.nextElementSibling);
            setTimeout(() => messageBox.remove(), 3000); 
        }// --- H√†m X√ÅO TR·ªòN M·∫¢NG (Fisher-Yates Shuffle) ---
        function shuffleArray(array) {
            let shuffled = array.slice(); // T·∫°o b·∫£n sao ƒë·ªÉ kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn d·ªØ li·ªáu g·ªëc
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }// --- Kh·ªüi t·∫°o s·ª± ki·ªán ---
        startButton.addEventListener('click', () => {
            // ƒê·∫£m b·∫£o reset tr·∫°ng th√°i tr∆∞·ªõc khi b·∫Øt ƒë·∫ßu
            currentQuestionIndex = 0;
            answeredQuestions = new Array(questions.length).fill(null);
            correctnessStatus = new Array(questions.length).fill(null);
            // questions = shuffleArray(questions); // X√°o tr·ªôn c√¢u h·ªèi
            startScreen.classList.add('hidden');
            quizContent.classList.remove('hidden');
            sidebar.classList.remove('hidden');
            createQuestionList();
            startTimer();
            showQuestion();
        });
        restartButton.addEventListener('click', restartQuiz);
        exitButton.addEventListener('click', () => {
            showMessage("ƒê√£ tho√°t kh·ªèi b√†i ki·ªÉm tra. D·ªØ li·ªáu l√†m b√†i hi·ªán t·∫°i s·∫Ω kh√¥ng ƒë∆∞·ª£c l∆∞u. ƒêang quay v·ªÅ m√†n h√¨nh b·∫Øt ƒë·∫ßu...", "red");
            setTimeout(goToStartScreen, 1000);
        });
    </script>
</body>
</html>